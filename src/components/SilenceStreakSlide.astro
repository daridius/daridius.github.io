---
import Slide from "./Slide.astro";
import { wrappedData, monthNames } from "../data";

const fmt = (dStr: string) => {
    const d = new Date(dStr);
    const day = d.getUTCDate();
    const month = monthNames[d.getUTCMonth()];
    return `${day} de ${month}`;
};
---

<Slide class="silence-slide">
    <div class="content">
        <h2>Y aunque desde el</h2>
        <div class="dates">
            <span class="highlight"
                >{fmt(wrappedData.longest_silence_streak.from)}</span
            >
            al
            <span class="highlight"
                >{fmt(wrappedData.longest_silence_streak.to)}</span
            >
        </div>
        <h2>no hubo se√±ales de vida...</h2>

        <div class="emoji-reaction">ü¶ó</div>
        <div class="days-count">
            {wrappedData.longest_silence_streak.days} d√≠as de silencio
        </div>
    </div>
</Slide>

<script>
    import { gsap } from "gsap";
    const slide = document.querySelector(".silence-slide");

    slide?.addEventListener("slide-enter", () => {
        const content = slide.querySelector(".content");
        const emoji = slide.querySelector(".emoji-reaction");

        if (content) {
            gsap.fromTo(
                content,
                { autoAlpha: 0 },
                { autoAlpha: 1, duration: 1 },
            );
        }

        if (emoji) {
            gsap.fromTo(
                emoji,
                { scale: 0 },
                { scale: 1, duration: 0.8, ease: "bounce.out", delay: 0.5 },
            );
        }
    });
</script>
<style>
    .content {
        text-align: center;
        opacity: 0;
        visibility: hidden;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
    }

    h2 {
        font-weight: 300;
        font-size: 1.5rem;
        margin: 0;
    }

    .dates {
        font-size: 2rem;
        margin: 1rem 0;
    }

    .highlight {
        color: #ff6b6b;
        font-weight: bold;
    }

    .emoji-reaction {
        font-size: 6rem;
        margin: 1rem 0;
    }

    .days-count {
        font-size: 1.2rem;
        color: var(--text-secondary);
    }
</style>
